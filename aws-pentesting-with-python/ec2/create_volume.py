import resource
import boto3
import json
import os
from json_datetime_serializer import json_datetime_serializer
import logging
from moto import mock_ec2
from describe_ec2_instances import describe_instances
from create_snapshot import create_snapshot

logger = logging.getLogger()
logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s: %(levelname)s: %(message)s')


# Creating Voume from EC2 Snapshot.

# @mock_ec2
def create_volume(instance_id, volume_size):
    client = boto3.client('ec2')
    # snapshot_id = create_snapshot(instance_id)
    response = client.create_volume(
        AvailabilityZone='us-east-1a',
        Size=volume_size,
        SnapshotId='snap-0249b13ce3716bff0',
        VolumeType='gp3',
    )
    return response['VolumeId']


if __name__ == '__main__':
    logger.info('Creating Volume function......!')
    instance_id = input('Enter an instance id: ')
    volume_size = int(input('Enter volume size: '))
    # logger.info(f'{type (volume_size)}')
    ec2_volume = create_volume(instance_id, volume_size)
    logger.info('Creating a snapshot ...')
    logger.info(
        f'Snapshot details: {json.dumps(ec2_volume, indent=4, default=json_datetime_serializer)}'
    )
    logger.info('Done!')
