from http import client
import boto3
import logging
import json
from json_datetime_serializer import json_datetime_serializer

logger = logging.getLogger()
logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s: %(levelname)s: %(message)s')


def create_buckets():
    client = boto3.client('s3')
    response = client.create_bucket(
        Bucket='demo32323ff334'
    )
    return response
  
def s3_upload():
    client = boto3.resource('s3')
    
    response = client.meta.client.upload_file('/home/mustofa/Documents/devops/scripting/python-scripting/aws-pentesting-with-python/s3/list_buckets.py', 's3_upload', 'hello.txt')

    return response


logger.info('Uploading object into bucket ...')
bucket = s3_upload()
logger.info(
    f'Bucket details: {json.dumps(bucket, indent=4, default=json_datetime_serializer)}'
)
logger.info('Done!')
