from http import client
import boto3
import logging
import json
from json_datetime_serializer import json_datetime_serializer

logger = logging.getLogger()
logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s: %(levelname)s: %(message)s')


def list_bucket_object(bucket_name):
    client = boto3.client('s3')
    response = client.list_objects(
    Bucket=bucket_name,
)
    return response['Contents']
    
logger.info('Listing objects from the bucket ...')
bucket = list_bucket_object('demo32323ff334')
logger.info(
    f'Bucket details: {json.dumps(bucket, indent=4, default=json_datetime_serializer)}'
)
logger.info('Done!')
