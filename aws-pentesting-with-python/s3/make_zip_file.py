from sys import float_repr_style
import boto3
import logging
import json
from json_datetime_serializer import json_datetime_serializer
import csv
import pandas as pd
from zipfile import ZipFile
import zipfile
import os 

logger = logging.getLogger()
logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s: %(levelname)s: %(message)s')



def make_zipfile(output_filename, source_dir, expected_file):
    relroot = os.path.abspath(os.path.join(source_dir, os.pardir))
    status = True
    with zipfile.ZipFile(output_filename, "w", zipfile.ZIP_DEFLATED) as zip:
        for root, subdirs, files in os.walk(source_dir):
            if not subdirs:
                logger.info(f'Not subdirs----{subdirs}')
                return False
            else:
                for file in files:
                    for new_files in expected_file:
                        if file == new_files:
                            filename = os.path.join(root, file)
                            logger.info(f'Adding file: {file}')
                            print(file)
                            if os.path.isfile(filename): # regular files only
                                print(filename)
                                # arcname = os.path.join(os.path.relpath(root, relroot), file)
                                zip.write(filename)
                        return True

                            
# make_zipfile("zipped", "./")