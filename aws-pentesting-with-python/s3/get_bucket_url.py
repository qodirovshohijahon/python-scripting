from http import client
import boto3
import logging
import json
from json_datetime_serializer import json_datetime_serializer

logger = logging.getLogger()
logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s: %(levelname)s: %(message)s')


def get_bucket_location(bucket_name, key_name):
    client = boto3.client('s3')
    response = client.get_bucket_location(Bucket=bucket_name)
    object_url = "https://s3-{0}.amazonaws.com/{1}/{2}".format(
        bucket_location['LocationConstraint'],
        bucket_name,
        key_name
    )
    return object_url
# response['LocationConstraint']
    
logger.info('Listing objects from the bucket ...')
bucket_location = get_bucket_location('demo32323ff334', 'Guardduty')
logger.info(
    f'Bucket details: {json.dumps(bucket_location, indent=4, default=json_datetime_serializer)}'
)
logger.info('Done!')


#s3_client = boto3.session.Session(profile_name='sssss').client('s3')
# s3_client=boto3.client('s3')
# s3_bucket_name = 'xxxxx'
# s3_website_URL= f"http://{s3_bucket_name}.s3-website.{s3_client.get_bucket_location(Bucket=s3_bucket_name)['LocationConstraint']}.amazonaws.com"
# Share
